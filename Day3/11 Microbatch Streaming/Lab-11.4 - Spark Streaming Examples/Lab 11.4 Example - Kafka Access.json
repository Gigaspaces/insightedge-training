{"paragraphs":[{"title":"Required Dependencies","text":"%dep\n\nz.load(\"org.apache.spark:spark-streaming_2.10:jar:1.6.2\")\nz.load(\"org.apache.spark:spark-streaming-kafka_2.10:jar:1.6.2\")\nz.load(\"org.apache.kafka:kafka_2.10:jar:0.10.0.1\")\nz.load(\"com.yammer.metrics:metrics-core:jar:2.2.0\")\nz.load(\"com.101tec:zkclient:jar:0.9\")\n","user":"anonymous","dateUpdated":"2019-01-23T15:08:01-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@3f03e4db\n"}]},"apps":[],"jobName":"paragraph_1548272753395_-1695880175","id":"20160830-145728_362255206","dateCreated":"2019-01-23T14:45:53-0500","dateStarted":"2019-01-23T15:08:01-0500","dateFinished":"2019-01-23T15:08:14-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:748"},{"title":"Read from Kafka Topic using Direct Stream","text":"%spark\n\nimport org.apache.spark.streaming.{Seconds, StreamingContext}\nimport _root_.kafka.serializer.StringDecoder\nimport org.apache.spark.streaming.kafka.KafkaUtils\n \nval ssc = new StreamingContext(sc, Seconds(30))\n\nssc.checkpoint(\"/tmp/checkpoint\")\n \nval kafkaParams = Map(\n    \"metadata.broker.list\" -> \"localhost:9092\",\n    \"auto.offset.reset\" -> \"smallest\"\n)\n \nval topics = Set(\"messages\")\n \nval messagesStream = KafkaUtils.createDirectStream[String, String, StringDecoder, StringDecoder](ssc, kafkaParams, topics).map(_._2)\n  \nmessagesStream.print()\n\nssc.start \n","user":"anonymous","dateUpdated":"2019-01-23T15:08:13-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"import org.apache.spark.streaming.{Seconds, StreamingContext}\nimport _root_.kafka.serializer.StringDecoder\nimport org.apache.spark.streaming.kafka.KafkaUtils\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@28b1aba1\nkafkaParams: scala.collection.immutable.Map[String,String] = Map(metadata.broker.list -> localhost:9092, auto.offset.reset -> smallest)\ntopics: scala.collection.immutable.Set[String] = Set(messages)\norg.apache.spark.SparkException: java.nio.channels.ClosedChannelException\n  at org.apache.spark.streaming.kafka.KafkaCluster$$anonfun$checkErrors$1.apply(KafkaCluster.scala:366)\n  at org.apache.spark.streaming.kafka.KafkaCluster$$anonfun$checkErrors$1.apply(KafkaCluster.scala:366)\n  at scala.util.Either.fold(Either.scala:98)\n  at org.apache.spark.streaming.kafka.KafkaCluster$.checkErrors(KafkaCluster.scala:365)\n  at org.apache.spark.streaming.kafka.KafkaUtils$.getFromOffsets(KafkaUtils.scala:222)\n  at org.apache.spark.streaming.kafka.KafkaUtils$.createDirectStream(KafkaUtils.scala:484)\n  ... 52 elided\n"}]},"apps":[],"jobName":"paragraph_1548272753403_406371956","id":"20160830-170427_1816087646","dateCreated":"2019-01-23T14:45:53-0500","dateStarted":"2019-01-23T15:08:13-0500","dateFinished":"2019-01-23T15:08:30-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:749"},{"text":"%spark\n\nssc.stop(stopSparkContext=false, stopGracefully=true)\n","user":"anonymous","dateUpdated":"2019-01-23T14:45:53-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548272753405_1494667185","id":"20160830-170845_1145510546","dateCreated":"2019-01-23T14:45:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:750"},{"user":"anonymous","dateUpdated":"2019-01-23T14:45:53-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548272753406_562612563","id":"20160830-165856_475845132","dateCreated":"2019-01-23T14:45:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:751"}],"name":"Lab 11.4 Example - Kafka Access","id":"2E3NW74Z1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}