{"paragraphs":[{"text":"%dep\n\nz.load(\"org.apache.spark:spark-streaming_2.10:1.6.2\")\nz.load(\"org.apache.spark:spark-streaming-twitter_2.10:1.6.2\")\nz.load(\"org.twitter4j:twitter4j-core:4.0.5\")\n","user":"anonymous","dateUpdated":"2019-01-23T14:39:47-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@10ee8f6d\n"}]},"apps":[],"jobName":"paragraph_1548272387016_-1696810014","id":"20160830-145728_362255206","dateCreated":"2019-01-23T14:39:47-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1550"},{"title":"Application showing tweeter messages containing matching words","text":"%spark\n\nimport org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\n\nval consumerKey = \"MYhSeverFcNomsZVK9rf97rtL\"\nval consumerSecret = \"PUr7MkkJQhFhO2Rb3CTax7NaZUpjHIVwQ5GcaQHad4QgmA7kNK\"\nval accessToken = \"829721281968877569-e8b48xjJDNRMALDPZwyU6Dl2VSIq2JQ\"\nval accessTokenSecret = \"0lk1ohTrHJeWUHhn76hlo4N5U16tIgM6A9Dm2Y8EKYuZp\"\n\nSystem.setProperty(\"twitter4j.oauth.consumerKey\", consumerKey)\nSystem.setProperty(\"twitter4j.oauth.consumerSecret\", consumerSecret)\nSystem.setProperty(\"twitter4j.oauth.accessToken\", accessToken)\nSystem.setProperty(\"twitter4j.oauth.accessTokenSecret\", accessTokenSecret)\n\nval ssc = new StreamingContext(sc, Seconds(30))\n\nssc.checkpoint(\"/tmp/checkpoint\")\n\nval filters = Seq(\"java\", \"scala\", \"spark\", \"hadoop\", \"kafka\", \"python\", \"flink\", \"nodejs\", \"docker\", \"tdd\")\n\nval tweets = TwitterUtils.createStream(ssc, None, filters)\n\nval tweetStatuses = tweets.map(t => t.getText())\n\nval wordCount = tweetStatuses\n                    .flatMap(line => line.split(\" \"))\n                    .map(w => w.toLowerCase())\n                    .filter(w => Seq(\"java\", \"scala\", \"spark\", \"hadoop\", \"kafka\", \"python\", \"flink\", \"nodejs\", \"docker\", \"tdd\").contains(w))\n                    .map(word => (word,1))\n                    .reduceByKey(_+_)\n                    .map(item => item.swap)\n                    .transform(rdd => rdd.sortByKey(false))\n                    \n\nwordCount.repartition(1).print()\n\nssc.start()\n","user":"anonymous","dateUpdated":"2019-01-23T14:42:31-0500","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\nconsumerKey: String = MYhSeverFcNomsZVK9rf97rtL\nconsumerSecret: String = PUr7MkkJQhFhO2Rb3CTax7NaZUpjHIVwQ5GcaQHad4QgmA7kNK\naccessToken: String = 829721281968877569-e8b48xjJDNRMALDPZwyU6Dl2VSIq2JQ\naccessTokenSecret: String = 0lk1ohTrHJeWUHhn76hlo4N5U16tIgM6A9Dm2Y8EKYuZp\nres7: String = MYhSeverFcNomsZVK9rf97rtL\nres8: String = PUr7MkkJQhFhO2Rb3CTax7NaZUpjHIVwQ5GcaQHad4QgmA7kNK\nres9: String = 829721281968877569-e8b48xjJDNRMALDPZwyU6Dl2VSIq2JQ\nres10: String = 0lk1ohTrHJeWUHhn76hlo4N5U16tIgM6A9Dm2Y8EKYuZp\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@563e150f\nfilters: Seq[String] = List(java, scala, spark, hadoop, kafka, python, flink, nodejs, docker, tdd)\ntweets: org.apache.spark.streaming.dstream.ReceiverInputDStream[twitter4j.Status] = org.apache.spark.streaming.twitter.TwitterInputDStream@7eac1721\ntweetStatuses: org.apache.spark.streaming.dstream.DStream[String] = org.apache.spark.streaming.dstream.MappedDStream@492aec6e\nwordCount: org.apache.spark.streaming.dstream.DStream[(Int, String)] = org.apache.spark.streaming.dstream.TransformedDStream@30628d75\n"}]},"apps":[],"jobName":"paragraph_1548272387019_-549630869","id":"20160825-135423_1775581826","dateCreated":"2019-01-23T14:39:47-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1551"},{"text":"%spark\n\nssc.stop(stopSparkContext=false, stopGracefully=true)\n","user":"anonymous","dateUpdated":"2019-01-23T14:39:47-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548272387022_2039015092","id":"20160825-133825_16834077","dateCreated":"2019-01-23T14:39:47-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1552"},{"user":"anonymous","dateUpdated":"2019-01-23T14:39:47-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548272387024_-144588336","id":"20160830-151349_1041624973","dateCreated":"2019-01-23T14:39:47-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1553"}],"name":"Lab 11.4 Example - Twitter Access","id":"2E12TFARE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}