{"paragraphs":[{"text":"%dep\n\nz.load(\"org.apache.spark:spark-streaming_2.10:1.6.2\")\nz.load(\"org.apache.spark:spark-streaming-twitter_2.10:1.6.2\")\nz.load(\"org.twitter4j:twitter4j-core:4.0.5\")\n","dateUpdated":"2017-02-09T02:30:18-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484583384340_-912114182","id":"20160830-145728_362255206","dateCreated":"2017-01-16T11:16:24-0500","dateStarted":"2017-02-09T02:30:18-0500","dateFinished":"2017-02-09T02:30:28-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15991"},{"title":"An application that shows cumulative frequency counts of words from a specified list of words in Twitter messages","text":"%spark\n\nimport org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.twitter._\nimport org.apache.spark.storage.StorageLevel\n\nval consumerKey = \"MYhSeverFcNomsZVK9rf97rtL\"\nval consumerSecret = \"PUr7MkkJQhFhO2Rb3CTax7NaZUpjHIVwQ5GcaQHad4QgmA7kNK\"\nval accessToken = \"829721281968877569-e8b48xjJDNRMALDPZwyU6Dl2VSIq2JQ\"\nval accessTokenSecret = \"0lk1ohTrHJeWUHhn76hlo4N5U16tIgM6A9Dm2Y8EKYuZp\"\n\nSystem.setProperty(\"twitter4j.oauth.consumerKey\", consumerKey)\nSystem.setProperty(\"twitter4j.oauth.consumerSecret\", consumerSecret)\nSystem.setProperty(\"twitter4j.oauth.accessToken\", accessToken)\nSystem.setProperty(\"twitter4j.oauth.accessTokenSecret\", accessTokenSecret)\n\nval ssc = new StreamingContext(sc, Seconds(30))\n\nssc.checkpoint(\"c:/tmp/checkpoint\")\n\nval filters = Seq(\"spark\", \"mesos\", \"docker\", \"tdd\", \"java\", \"scala\", \"ruby\", \"golang\")\n\nval tweets = TwitterUtils.createStream(ssc, None, filters, StorageLevel.MEMORY_ONLY_SER_2)\n\nval statuses = tweets.filter(t => t.getLang() == \"en\").map(t => t.getText())\n\nval words = statuses\n                .flatMap{status => status.split(\"\\\\s+\")}\n                .map(w => w.toLowerCase)\n                .filter(w => Seq(\"spark\", \"mesos\", \"docker\", \"tdd\", \"java\", \"scala\", \"ruby\", \"golang\").contains(w))\n\nval wordPairs = words.map{word => (word, 1)}\n\nval wordsWithCounts = wordPairs.updateStateByKey( (counts: Seq[Int], prevCount: Option[Int]) =>\n    prevCount.map{c => c + counts.sum}.orElse{Some(counts.sum)}\n)\n\nwordsWithCounts.repartition(1).print()\n\nssc.start()\n","dateUpdated":"2017-02-09T02:36:07-0500","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484583384341_-912498931","id":"20160825-135423_1775581826","dateCreated":"2017-01-16T11:16:24-0500","dateStarted":"2017-02-09T02:36:07-0500","dateFinished":"2017-02-09T02:36:15-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15992"},{"text":"%spark\n\nssc.stop(stopSparkContext=false, stopGracefully=true)\n","dateUpdated":"2017-02-09T02:37:36-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484583384341_-912498931","id":"20160825-133825_16834077","dateCreated":"2017-01-16T11:16:24-0500","dateStarted":"2017-02-09T02:37:36-0500","dateFinished":"2017-02-09T02:39:00-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15993"},{"dateUpdated":"2017-01-16T11:16:24-0500","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1484583384341_-912498931","id":"20160830-151349_1041624973","dateCreated":"2017-01-16T11:16:24-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15994"}],"name":"Lab 11.4 Example - Using State","id":"2C8ADC14M","angularObjects":{"2C14DCYPT:shared_process":[],"2BXE9YPBX:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}
