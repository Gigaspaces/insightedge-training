{"paragraphs":[{"title":"Creating DataFrame from an RDD","text":"%md\n\nThe data file <b>video-games-sales.csv</b> contains sample data for video games sales.\n\n<pre>\n\n<b>Name,Platform,Year_of_Release,Global_Sales</b>\nWii Sports,Wii,2006,82.53\nSuper Mario Bros.,NES,1985,40.24\nMario Kart Wii,Wii,2008,35.52\nWii Sports Resort,Wii,2009,32.77\nPokemon Red/Pokemon Blue,GB,1996,31.37\n\n</pre>\n\nCreate an RDD and convert it to a DataFrame.\n\n","user":"anonymous","dateUpdated":"2019-01-23T12:12:48-0500","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The data file <b>video-games-sales.csv</b> contains sample data for video games sales.</p>\n<pre>\n\n<b>Name,Platform,Year_of_Release,Global_Sales</b>\nWii Sports,Wii,2006,82.53\nSuper Mario Bros.,NES,1985,40.24\nMario Kart Wii,Wii,2008,35.52\nWii Sports Resort,Wii,2009,32.77\nPokemon Red/Pokemon Blue,GB,1996,31.37\n\n</pre>\n<p>Create an RDD and convert it to a DataFrame.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548263135774_741118300","id":"20160822-145305_1775455394","dateCreated":"2019-01-23T12:05:35-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10502","dateFinished":"2019-01-23T12:12:48-0500","dateStarted":"2019-01-23T12:12:48-0500"},{"text":"%spark\n\ncase class VideoGameSale(name:String, platform:String, yearOfRelease:Int, globalSales:Double)\n\nval rowsRDD = sc.textFile(\"../../../../Data/video-games-sales.csv\").filter(line => (! line.endsWith(\"Global_Sales\")) && (! line.contains(\"N/A\")))\n\nval salesRDD = rowsRDD.map{row => row.split(\",\")}.map{cols => VideoGameSale(cols(0), cols(1), cols(2).trim.toInt, cols(3).trim.toDouble)}\n\nval salesDF = salesRDD.toDF()\n\nsalesDF.show\n","user":"anonymous","dateUpdated":"2019-01-23T12:09:38-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class VideoGameSale\nrowsRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[203] at filter at <console>:39\nsalesRDD: org.apache.spark.rdd.RDD[VideoGameSale] = MapPartitionsRDD[205] at map at <console>:43\nsalesDF: org.apache.spark.sql.DataFrame = [name: string, platform: string ... 2 more fields]\n+--------------------+--------+-------------+-----------+\n|                name|platform|yearOfRelease|globalSales|\n+--------------------+--------+-------------+-----------+\n|          Wii Sports|     Wii|         2006|      82.53|\n|   Super Mario Bros.|     NES|         1985|      40.24|\n|      Mario Kart Wii|     Wii|         2008|      35.52|\n|   Wii Sports Resort|     Wii|         2009|      32.77|\n|Pokemon Red/Pokem...|      GB|         1996|      31.37|\n|              Tetris|      GB|         1989|      30.26|\n|New Super Mario B...|      DS|         2006|       29.8|\n|            Wii Play|     Wii|         2006|      28.92|\n|New Super Mario B...|     Wii|         2009|      28.32|\n|           Duck Hunt|     NES|         1984|      28.31|\n|          Nintendogs|      DS|         2005|      24.67|\n|       Mario Kart DS|      DS|         2005|      23.21|\n|Pokemon Gold/Poke...|      GB|         1999|       23.1|\n|             Wii Fit|     Wii|         2007|       22.7|\n|  Kinect Adventures!|    X360|         2010|      21.81|\n|        Wii Fit Plus|     Wii|         2009|      21.79|\n|  Grand Theft Auto V|     PS3|         2013|      21.04|\n|Grand Theft Auto:...|     PS2|         2004|      20.81|\n|   Super Mario World|    SNES|         1990|      20.61|\n|Brain Age: Train ...|      DS|         2005|      20.15|\n+--------------------+--------+-------------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1548263135775_527614645","id":"20170228-005312_361356901","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10503","title":"Solution"},{"title":"DataFrame operations","text":"%md\n\nFind the following for the DataFrame created in the previous exercise:\n\n<ol>\n<li>Description of the columns in the dataframe.\n<li>The schema of the dataframe\n<li>The first 50 rows of the dataframe\n</ol>\n\n","user":"anonymous","dateUpdated":"2019-01-23T12:05:35-0500","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Find the following for the DataFrame created in the previous exercise:</p>\n<ol>\n<li>Description of the columns in the dataframe.\n<li>The schema of the dataframe\n<li>The first 50 rows of the dataframe\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1548263135775_-1774710779","id":"20160822-163830_1257397604","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10504"},{"text":"%spark\n\nsalesDF.columns\n\nsalesDF.printSchema\n\nsalesDF.show(50)\n","user":"anonymous","dateUpdated":"2019-01-23T12:05:35-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res116: Array[String] = Array(name, platform, yearOfRelease, globalSales)\nroot\n |-- name: string (nullable = true)\n |-- platform: string (nullable = true)\n |-- yearOfRelease: integer (nullable = false)\n |-- globalSales: double (nullable = false)\n\n+--------------------+--------+-------------+-----------+\n|                name|platform|yearOfRelease|globalSales|\n+--------------------+--------+-------------+-----------+\n|          Wii Sports|     Wii|         2006|      82.53|\n|   Super Mario Bros.|     NES|         1985|      40.24|\n|      Mario Kart Wii|     Wii|         2008|      35.52|\n|   Wii Sports Resort|     Wii|         2009|      32.77|\n|Pokemon Red/Pokem...|      GB|         1996|      31.37|\n|              Tetris|      GB|         1989|      30.26|\n|New Super Mario B...|      DS|         2006|       29.8|\n|            Wii Play|     Wii|         2006|      28.92|\n|New Super Mario B...|     Wii|         2009|      28.32|\n|           Duck Hunt|     NES|         1984|      28.31|\n|          Nintendogs|      DS|         2005|      24.67|\n|       Mario Kart DS|      DS|         2005|      23.21|\n|Pokemon Gold/Poke...|      GB|         1999|       23.1|\n|             Wii Fit|     Wii|         2007|       22.7|\n|  Kinect Adventures!|    X360|         2010|      21.81|\n|        Wii Fit Plus|     Wii|         2009|      21.79|\n|  Grand Theft Auto V|     PS3|         2013|      21.04|\n|Grand Theft Auto:...|     PS2|         2004|      20.81|\n|   Super Mario World|    SNES|         1990|      20.61|\n|Brain Age: Train ...|      DS|         2005|      20.15|\n|Pokemon Diamond/P...|      DS|         2006|      18.25|\n|    Super Mario Land|      GB|         1989|      18.14|\n| Super Mario Bros. 3|     NES|         1988|      17.28|\n|  Grand Theft Auto V|    X360|         2013|      16.27|\n|Grand Theft Auto:...|     PS2|         2002|      16.15|\n|Pokemon Ruby/Poke...|     GBA|         2002|      15.85|\n|Brain Age 2: More...|      DS|         2005|      15.29|\n|Pokemon Black/Pok...|      DS|         2010|      15.14|\n|Gran Turismo 3: A...|     PS2|         2001|      14.98|\n|Call of Duty: Mod...|    X360|         2011|      14.73|\n|Pokémon Yellow: S...|      GB|         1998|      14.64|\n|Call of Duty: Bla...|     PS4|         2015|      14.63|\n|Call of Duty: Bla...|    X360|         2010|      14.61|\n| Pokemon X/Pokemon Y|     3DS|         2013|       14.6|\n|Call of Duty: Bla...|     PS3|         2012|      13.79|\n|Call of Duty: Bla...|    X360|         2012|      13.67|\n|Call of Duty: Mod...|    X360|         2009|      13.47|\n|Call of Duty: Mod...|     PS3|         2011|      13.32|\n|Grand Theft Auto III|     PS2|         2001|       13.1|\n|Super Smash Bros....|     Wii|         2008|      12.84|\n|        Mario Kart 7|     3DS|         2011|      12.66|\n|Call of Duty: Bla...|     PS3|         2010|      12.63|\n|  Grand Theft Auto V|     PS4|         2014|      12.61|\n|Animal Crossing: ...|      DS|         2005|      12.13|\n|              Halo 3|    X360|         2007|      12.12|\n|      Super Mario 64|     N64|         1996|      11.89|\n|Pokemon HeartGold...|      DS|         2009|      11.77|\n|Pokemon Omega Rub...|     3DS|         2014|      11.68|\n|      Gran Turismo 4|     PS2|         2004|      11.66|\n|  Super Mario Galaxy|     Wii|         2007|      11.35|\n+--------------------+--------+-------------+-----------+\nonly showing top 50 rows\n\n"}]},"apps":[],"jobName":"paragraph_1548263135776_205429932","id":"20170228-010108_774146336","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10505"},{"title":"What are the video games listed for the year 2009 ?","text":"%spark\n\nsalesDF.select(\"name\", \"yearOfRelease\").filter(\"yearOfRelease = 2009\").show\n","user":"anonymous","dateUpdated":"2019-01-23T12:08:17-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------+\n|                name|yearOfRelease|\n+--------------------+-------------+\n|   Wii Sports Resort|         2009|\n|New Super Mario B...|         2009|\n|        Wii Fit Plus|         2009|\n|Call of Duty: Mod...|         2009|\n|Pokemon HeartGold...|         2009|\n|Call of Duty: Mod...|         2009|\n|          The Sims 3|         2009|\n|          Just Dance|         2009|\n|Uncharted 2: Amon...|         2009|\n|        Halo 3: ODST|         2009|\n|Dragon Quest IX: ...|         2009|\n| Assassin's Creed II|         2009|\n|  Forza Motorsport 3|         2009|\n|  Final Fantasy XIII|         2009|\n| Assassin's Creed II|         2009|\n|     Resident Evil 5|         2009|\n|Mario & Sonic at ...|         2009|\n|Batman: Arkham As...|         2009|\n|   Street Fighter IV|         2009|\n|       Left 4 Dead 2|         2009|\n+--------------------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1548263135776_1288429897","id":"20160823-180618_860695558","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10506"},{"title":"What are the sales of video games for the year 2009 ?","text":"%spark\n\nval x = salesDF.filter(\"yearOfRelease = 2009\").select(\"globalSales\", \"yearOfRelease\")\n\nx.show\n\n","user":"anonymous","dateUpdated":"2019-01-23T12:05:35-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"x: org.apache.spark.sql.DataFrame = [globalSales: double, yearOfRelease: int]\n+-----------+-------------+\n|globalSales|yearOfRelease|\n+-----------+-------------+\n|      32.77|         2009|\n|      28.32|         2009|\n|      21.79|         2009|\n|      13.47|         2009|\n|      11.77|         2009|\n|       10.6|         2009|\n|       8.01|         2009|\n|        7.2|         2009|\n|       6.66|         2009|\n|       6.34|         2009|\n|       5.78|         2009|\n|       5.55|         2009|\n|       5.49|         2009|\n|       5.33|         2009|\n|       5.26|         2009|\n|       5.09|         2009|\n|       4.53|         2009|\n|       4.23|         2009|\n|       4.16|         2009|\n|       3.97|         2009|\n+-----------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1548263135777_-93568008","id":"20160825-002634_332193277","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10507"},{"text":"","user":"anonymous","dateUpdated":"2019-01-23T12:05:35-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548263135777_134794946","id":"20160825-005916_631693256","dateCreated":"2019-01-23T12:05:35-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10508"}],"name":"Lab 6.4 Solution - DataFrame Operations and SQL Usage","id":"2E2DYT7TE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}