{"paragraphs":[{"text":"%md\n\n<h3>Examples illustrating <b>Pair RDDs</b></h3>\n\n<p>\nWe have a data file, <b>data_transactions.txt</b>, containing customer transactions of a store.</p>\n<p>\n<p>\nFirst ten lines from the data file are as follows:\n\n<pre>\n<b>transaction date#time#customer id#product id#quantity#product price</b>\n2015-03-30#6:55 AM#51#68#1#9506.21\n2015-03-30#7:39 PM#99#86#5#4107.59\n2015-03-30#11:57 AM#79#58#7#2987.22\n2015-03-30#12:46 AM#51#50#6#7501.89\n2015-03-30#11:39 AM#86#24#5#8370.2\n2015-03-30#10:35 AM#63#19#5#1023.57\n2015-03-30#2:30 AM#23#77#7#5892.41\n2015-03-30#7:41 PM#49#58#4#9298.18\n2015-03-30#9:18 AM#97#86#8#9462.89\n</pre>\n\nEach line in the file contains the following fields delimited with hash signs:\n\n<ul>\n<li>transaction date</li> \n<li>time</li>\n<li>customer ID</li> \n<li>product ID</li> \n<li>quantity</li>\n<li>product price</li> \n</ul>\n\n</p>\n","user":"anonymous","dateUpdated":"2018-12-25T16:26:15+0200","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Examples illustrating <b>Pair RDDs</b></h3>\n<p>\nWe have a data file, <b>data_transactions.txt</b>, containing customer transactions of a store.</p>\n<p><p></p>\n<p>\nFirst ten lines from the data file are as follows:\n\n<pre>\n<b>transaction date#time#customer id#product id#quantity#product price</b>\n2015-03-30#6:55 AM#51#68#1#9506.21\n2015-03-30#7:39 PM#99#86#5#4107.59\n2015-03-30#11:57 AM#79#58#7#2987.22\n2015-03-30#12:46 AM#51#50#6#7501.89\n2015-03-30#11:39 AM#86#24#5#8370.2\n2015-03-30#10:35 AM#63#19#5#1023.57\n2015-03-30#2:30 AM#23#77#7#5892.41\n2015-03-30#7:41 PM#49#58#4#9298.18\n2015-03-30#9:18 AM#97#86#8#9462.89\n</pre>\n\nEach line in the file contains the following fields delimited with hash signs:\n\n<ul>\n<li>transaction date</li> \n<li>time</li>\n<li>customer ID</li> \n<li>product ID</li> \n<li>quantity</li>\n<li>product price</li> \n</ul>\n\n</p>\n"}]},"apps":[],"jobName":"paragraph_1545747975217_-820869976","id":"20161018-203104_1249834388","dateCreated":"2018-12-25T16:26:15+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:70533"},{"text":"%md\n\n<h4>Creating Pair RDD</h4>\n\nEach line in the file contains transaction date, time, customer ID, product ID, quantity, and\nthe product price, delimited with hash signs.\nPlease create a pair RDD with customer IDs as keys and the complete transaction data as values. The RDD should contain the first 20 transactions.\n","user":"anonymous","dateUpdated":"2018-12-26T10:50:20+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Creating Pair RDD</h4>\n<p>Each line in the file contains transaction date, time, customer ID, product ID, quantity, and<br/>the product price, delimited with hash signs.<br/>Please create a pair RDD with customer IDs as keys and the complete transaction data as values. The RDD should contain the first 20 transactions.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545747975217_354241110","id":"20161018-204026_1429116242","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T10:50:20+0200","dateFinished":"2018-12-26T10:50:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70534"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T10:50:50+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"transactionData: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[167] at map at <console>:37\ntransactionsByCustomer: org.apache.spark.rdd.RDD[(Int, Array[String])] = MapPartitionsRDD[168] at map at <console>:39\nres90: Array[(Int, Array[String])] = Array((51,Array(2015-03-30, 6:55 AM, 51, 68, 1, 9506.21)))\n"}]},"apps":[],"jobName":"paragraph_1545747975218_1296251120","id":"20161018-204136_1241756262","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T10:46:44+0200","dateFinished":"2018-12-26T10:46:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70535"},{"text":"%md\n\n<h4>Getting keys and values from pair RDD</h4>\n\n<p>\nNow that we have the pair RDD, let us first see how many customers actually\nbought anything the previous day.\n</p>\n<p>\nWe can get a new RDD containing only the keys or only the\nvalues with pair RDD transformations named <b>keys</b> and <b>values</b>.\n</p>\n<p>\nSo we use this line to get a list of customer IDs, remove any duplicates and count the\nnumber of unique customer IDs:\n</p>","user":"anonymous","dateUpdated":"2018-12-25T16:26:15+0200","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Getting keys and values from pair RDD</h4>\n<p>\nNow that we have the pair RDD, let us first see how many customers actually\nbought anything the previous day.\n</p>\n<p>\nWe can get a new RDD containing only the keys or only the\nvalues with pair RDD transformations named <b>keys</b> and <b>values</b>.\n</p>\n<p>\nSo we use this line to get a list of customer IDs, remove any duplicates and count the\nnumber of unique customer IDs:\n</p>\n"}]},"apps":[],"jobName":"paragraph_1545747975218_1396435527","id":"20161018-204659_1317533356","dateCreated":"2018-12-25T16:26:15+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70536"},{"text":"%spark\n\n// get a pair RDD containing only the keys (customer id)\n\n\n// get the RDD keys as an array (contain duplication keys)\n\n\n// remove duplication keys\n\n\n// get the RDD keys as an array (after remove duplication)\n\n\n// count the keys\n","user":"anonymous","dateUpdated":"2018-12-26T11:27:59+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975219_-107586004","id":"20161018-204927_2119367398","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-25T16:29:40+0200","dateFinished":"2018-12-25T16:29:42+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70537"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T13:16:00+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545822960072_-1785681038","id":"20181226-131600_1151894894","dateCreated":"2018-12-26T13:16:00+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:70538"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T13:16:19+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545822979058_1765935119","id":"20181226-131619_407628063","dateCreated":"2018-12-26T13:16:19+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:70539"},{"title":"Find the customer who perfomed the greatest number of transactions","text":"%md\n\n<p>\nEach line in the transactions file is one transaction. \n</p>\n<p>\nWe first compute the transaction count for each customer using the <b>countByKey</b> action.\n</p>\n<p>\nThe map is then flattened to a sequence of 2-tuples, sorted by the second member of each tuple, and the last element picked up. \n</p>\n","user":"anonymous","dateUpdated":"2018-12-26T13:16:19+0200","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975219_-1447829768","id":"20161018-205444_178800548","dateCreated":"2018-12-25T16:26:15+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70540"},{"title":"Solution shown in granular steps","text":"%spark\n\n\n// get a pair RDD containing only the keys (customer id)\n     \n// find the transactions number for each customer and print it as a map\n\n// print it as a sequence\n\n// sort the sequence and find the customer who made the largest number of transactions\n\n","user":"anonymous","dateUpdated":"2018-12-26T12:02:17+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545747975219_682991192","id":"20161019-103208_55936394","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T12:02:17+0200","dateFinished":"2018-12-26T12:02:17+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70541"},{"title":"Solution as a single pipeline","text":"%spark\n\n\n","user":"anonymous","dateUpdated":"2018-12-26T14:22:25+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975220_2045441183","id":"20161019-111739_1860889492","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T12:03:15+0200","dateFinished":"2018-12-26T12:03:17+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70542"},{"title":"Show transactions involving Barbie Shopping Mall Playsets (product id 10)","text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:27:18+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975220_51511306","id":"20161019-115255_1076762662","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-25T16:31:25+0200","dateFinished":"2018-12-25T16:31:26+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70543"},{"title":"Give a 5% discount to customers who bought  2 or more Barbie Shopping Mall Playsets (product id 10)","text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:27:07+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975221_-1316359788","id":"20161019-112547_2042277195","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T14:13:47+0200","dateFinished":"2018-12-26T14:13:48+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70544"},{"title":"Find the customer that spent the most","text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:27:04+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975221_-760003105","id":"20161019-115619_755834342","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-25T16:32:20+0200","dateFinished":"2018-12-25T16:32:25+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70545"},{"title":"Find the customer that spent the most. Write  a Single Pipeline solution","text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:24:51+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975222_486575753","id":"20161020-225243_387507674","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-26T14:19:39+0200","dateFinished":"2018-12-26T14:19:40+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70546"},{"title":"Get list of all products purchased by customers","text":"%spark\n\n","user":"anonymous","dateUpdated":"2018-12-26T14:24:26+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975222_447030093","id":"20161019-140959_1286778763","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-25T16:33:54+0200","dateFinished":"2018-12-25T16:33:57+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70547"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:25:02+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545827078659_-1833559306","id":"20181226-142438_641041135","dateCreated":"2018-12-26T14:24:38+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:70548"},{"title":"Single Pipeline solution","text":"%spark\n","user":"anonymous","dateUpdated":"2018-12-26T14:26:29+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545747975222_-1277060497","id":"20161020-225722_1540411274","dateCreated":"2018-12-25T16:26:15+0200","dateStarted":"2018-12-25T16:35:28+0200","dateFinished":"2018-12-25T16:35:29+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70549"}],"name":"Lab 5.4 Exercise - RDD Pair RDDs","id":"2DZVJ2UH1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}