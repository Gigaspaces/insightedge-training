{"paragraphs":[{"title":"Creating DataFrame from an RDD","text":"%md\n\nThe data file <b>video-games-sales.csv</b> contains sample data for video games sales.\n\n<pre>\n\n<b>Name,Platform,Year_of_Release,Global_Sales</b>\nWii Sports,Wii,2006,82.53\nSuper Mario Bros.,NES,1985,40.24\nMario Kart Wii,Wii,2008,35.52\nWii Sports Resort,Wii,2009,32.77\nPokemon Red/Pokemon Blue,GB,1996,31.37\n\n</pre>\n\nCreate a suitable case class and load this data into an RDD.\n\n","user":"anonymous","dateUpdated":"2018-12-31T14:59:48+0200","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>The data file <b>video-games-sales.csv</b> contains sample data for video games sales.</p>\n<pre>\n\n<b>Name,Platform,Year_of_Release,Global_Sales</b>\nWii Sports,Wii,2006,82.53\nSuper Mario Bros.,NES,1985,40.24\nMario Kart Wii,Wii,2008,35.52\nWii Sports Resort,Wii,2009,32.77\nPokemon Red/Pokemon Blue,GB,1996,31.37\n\n</pre>\n<p>Create a suitable case class and load this data into an RDD.</p>\n"}]},"apps":[],"jobName":"paragraph_1546261188923_390714821","id":"20160822-145305_1775455394","dateCreated":"2018-12-31T14:59:48+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16326"},{"text":"%spark\n\ncase class VideoGameSale(name:String, platform:String, yearOfRelease:Int, globalSales:Double)\n\nval rowsRDD = sc.textFile(\"../../../../data/video-games-sales.csv\").filter(line => (! line.endsWith(\"Global_Sales\")) && (! line.contains(\"N/A\")))\n\nval salesRDD = rowsRDD.map{row => row.split(\",\")}.map{cols => VideoGameSale(cols(0), cols(1), cols(2).trim.toInt, cols(3).trim.toDouble)}\n\nval salesDF = salesRDD.toDF()\n\nsalesDF.show\n","user":"anonymous","dateUpdated":"2018-12-31T15:01:27+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class VideoGameSale\nrowsRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[175] at filter at <console>:82\nsalesRDD: org.apache.spark.rdd.RDD[VideoGameSale] = MapPartitionsRDD[177] at map at <console>:86\nsalesDF: org.apache.spark.sql.DataFrame = [name: string, platform: string, yearOfRelease: int, globalSales: double]\n+--------------------+--------+-------------+-----------+\n|                name|platform|yearOfRelease|globalSales|\n+--------------------+--------+-------------+-----------+\n|          Wii Sports|     Wii|         2006|      82.53|\n|   Super Mario Bros.|     NES|         1985|      40.24|\n|      Mario Kart Wii|     Wii|         2008|      35.52|\n|   Wii Sports Resort|     Wii|         2009|      32.77|\n|Pokemon Red/Pokem...|      GB|         1996|      31.37|\n|              Tetris|      GB|         1989|      30.26|\n|New Super Mario B...|      DS|         2006|       29.8|\n|            Wii Play|     Wii|         2006|      28.92|\n|New Super Mario B...|     Wii|         2009|      28.32|\n|           Duck Hunt|     NES|         1984|      28.31|\n|          Nintendogs|      DS|         2005|      24.67|\n|       Mario Kart DS|      DS|         2005|      23.21|\n|Pokemon Gold/Poke...|      GB|         1999|       23.1|\n|             Wii Fit|     Wii|         2007|       22.7|\n|  Kinect Adventures!|    X360|         2010|      21.81|\n|        Wii Fit Plus|     Wii|         2009|      21.79|\n|  Grand Theft Auto V|     PS3|         2013|      21.04|\n|Grand Theft Auto:...|     PS2|         2004|      20.81|\n|   Super Mario World|    SNES|         1990|      20.61|\n|Brain Age: Train ...|      DS|         2005|      20.15|\n+--------------------+--------+-------------+-----------+\nonly showing top 20 rows\n\r\n"}]},"apps":[],"jobName":"paragraph_1546261189066_1579483048","id":"20170228-005312_361356901","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16327"},{"title":"DataFrame operations","text":"%md\n\nFind the following for the DataFrame created in the previous exercise:\n\n<ol>\n<li>Description of the columns in the dataframe.\n<li>The schema of the dataframe\n<li>The first 50 rows of the dataframe\n</ol>\n\n","user":"anonymous","dateUpdated":"2018-12-31T14:59:49+0200","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9,"editorSetting":{}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Find the following for the DataFrame created in the previous exercise:</p>\n<ol>\n<li>Description of the columns in the dataframe.\n<li>The schema of the dataframe\n<li>The first 50 rows of the dataframe\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1546261189069_902740197","id":"20160822-163830_1257397604","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16328"},{"text":"%spark\n\nsalesDF.columns\n\nsalesDF.printSchema\n\nsalesDF.show(50)\n","user":"anonymous","dateUpdated":"2018-12-31T14:59:49+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546261189070_-1588548527","id":"20170228-010108_774146336","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16329"},{"title":"What are the video games listed for the year 2009 ?","text":"%spark\n\nsalesDF.select(\"name\", \"yearOfRelease\").filter(\"yearOfRelease = 2009\").show\n","user":"anonymous","dateUpdated":"2018-12-31T14:59:49+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546261189071_1257682848","id":"20160823-180618_860695558","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16330"},{"title":"What are the sales of video games for the year 2009 ?","text":"%spark\n\nval x = salesDF.filter(\"yearOfRelease = 2009\").select(\"globalSales\", \"yearOfRelease\")\n\nx.show\n\n","user":"anonymous","dateUpdated":"2018-12-31T14:59:49+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546261189072_-82102046","id":"20160825-002634_332193277","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16331"},{"text":"","user":"anonymous","dateUpdated":"2018-12-31T14:59:49+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546261189075_-489245986","id":"20160825-005916_631693256","dateCreated":"2018-12-31T14:59:49+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16332"}],"name":"Lab 6.5 Solution - DataFrame Operations and SQL Usage","id":"2DZ6KP2FE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}