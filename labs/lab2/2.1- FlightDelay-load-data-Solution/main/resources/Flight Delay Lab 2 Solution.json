{"paragraphs":[{"text":"%md\n> If you see 'Interpreter binding' above, just hit `Save` without deselecting any interpreters.\n\n## Welcome to Flights example.\n\n##### This example shows some features of InsightEdge:\n\n* Integrate java model classes in zeplin notebook\n* Read csv file containing data into RDD\n* Save data to the grid\n\n##### This is a live tutorial, you can run the code yourself. _(click `Run` button in each paragraph from top to bottom)_","user":"anonymous","dateUpdated":"2018-11-26T13:07:56+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<blockquote>\n  <p>If you see &lsquo;Interpreter binding&rsquo; above, just hit <code>Save</code> without deselecting any interpreters.</p>\n</blockquote>\n<h2>Welcome to Flights example.</h2>\n<h5>This example shows some features of InsightEdge:</h5>\n<ul>\n  <li>Integrate java model classes in zeplin notebook</li>\n  <li>Read csv file containing data into RDD</li>\n  <li>Save data to the grid</li>\n</ul>\n<h5>This is a live tutorial, you can run the code yourself. <em>(click <code>Run</code> button in each paragraph from top to bottom)</em></h5>\n</div>"}]},"apps":[],"jobName":"paragraph_1543230476863_284715534","id":"20170620-093024_406952967","dateCreated":"2018-11-26T13:07:56+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14053"},{"title":"Import dependencies","text":"%dep\n\nz.reset()\n// ToDo : point to the jar conatining the java DelayRec class\n// Note: This interpeter should be the first to run, If you need to update the jar and rerun after moving to another pargaph - restart the other interperter by going to interpeters menue\nz.load(\"C:/gs/12.3/gigaspaces-insightedge-12.3.0-m10-b18910/gigaspaces-insightedge-12.3.0-m10-b18910/insightedge/examples/jars/FlightDelayDemo-1.0.0-SNAPSHOT.jar\")","user":"anonymous","dateUpdated":"2018-11-26T13:07:56+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@29030b03\n"}]},"apps":[],"jobName":"paragraph_1543230476873_-677666319","id":"20180103-104153_1795376572","dateCreated":"2018-11-26T13:07:56+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14054"},{"text":"%md\n## Defining data model.\n\n##### `%define` allows you to append custom code to spark jobs. This is a nice place to write your model classes. To learn about syntax, please, refer to [Data Modeling](http://insightedge.io/docs/010/2_modeling.html).\n##### In this case the class is defined in the dependencies jar, but it can be defined here aswell.\n##### In the next section we will read csv file containing flight delay data, and save it to the grid\n##### Data was taken from http://stat-computing.org/dataexpo/2009/the-data.html","user":"anonymous","dateUpdated":"2018-11-26T13:07:56+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Defining data model.</h2>\n<h5><code>%define</code> allows you to append custom code to spark jobs. This is a nice place to write your model classes. To learn about syntax, please, refer to <a href=\"http://insightedge.io/docs/010/2_modeling.html\">Data Modeling</a>.</h5>\n<h5>In this case the class is defined in the dependencies jar, but it can be defined here aswell.</h5>\n<h5>In the next section we will read csv file containing flight delay data, and save it to the grid</h5>\n<h5>Data was taken from <a href=\"http://stat-computing.org/dataexpo/2009/the-data.html\">http://stat-computing.org/dataexpo/2009/the-data.html</a></h5>\n</div>"}]},"apps":[],"jobName":"paragraph_1543230476874_1772560917","id":"20170620-093134_1087314216","dateCreated":"2018-11-26T13:07:56+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14055"},{"title":"Saving Flight delay RDD to the Grid","text":"%spark\n\nimport common.DelayRec\nimport org.insightedge.spark.implicits.all._\n\n//Reading and filtering the data\nval data = sc.textFile(\"C:/gs/12.3/2007.csv\").map(line => line.split(\",\"))\n.filter(rec => rec(4).toString() != \"NA\") //filter NA values\n.filter(rec => rec(0) !=\"Year\")           //Filer header\n.filter(rec => rec(21).toString() != \"1\")   //filter canceled flights\n.filter(rec => rec(16).toString() == \"ORD\") //filter origin to have less records in the example\n.map(rec => new DelayRec( rec(9).toString(),rec(0).toInt,rec(1).toInt,rec(2).toInt,rec(3).toInt,rec(5).toInt,rec(15).toInt,rec(16).toString(),rec(18).toDouble))\n   \n//see how the data looks like    \ndata.take(5).map(x => x.toString() ).foreach(println)\n\n//save the data to the grid (routing is flight number, id is flight+date)\ndata.saveToGrid()\n    \n\n","user":"anonymous","dateUpdated":"2018-11-26T13:45:00+0200","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport common.DelayRec\n\nimport org.insightedge.spark.implicits.all._\n\ndata: org.apache.spark.rdd.RDD[common.DelayRec] = MapPartitionsRDD[7] at map at <console>:44\ncommon.DelayRec@69813fd\r\ncommon.DelayRec@7d1bc25\r\ncommon.DelayRec@561b0343\r\ncommon.DelayRec@2730f0f\r\ncommon.DelayRec@44b2f347\r\n"}]},"apps":[],"jobName":"paragraph_1543230476875_-1337643328","id":"20170620-093337_2060899833","dateCreated":"2018-11-26T13:07:56+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14056"},{"text":"%md\n## Congratulations, it's done.\n##### You can create your own notebook in 'Notebook' menu. Good luck!\n","user":"anonymous","dateUpdated":"2018-11-26T13:07:56+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Congratulations, it&rsquo;s done.</h2>\n<h5>You can create your own notebook in &lsquo;Notebook&rsquo; menu. Good luck!</h5>\n</div>"}]},"apps":[],"jobName":"paragraph_1543230476887_-409029003","id":"20170620-093845_67106827","dateCreated":"2018-11-26T13:07:56+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14057"}],"name":"Flight Delay Lab 2 Solution","id":"2DVNCURYM","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}