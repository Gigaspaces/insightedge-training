{"paragraphs":[{"text":"%md\n\n## Introduction\n\nGraphX is the Spark API for graph processing. \n\nIt provides a wrapper around an RDD called **resilient distributed property graph**. \n\n_The property graph is a directed multigraph with properties attached to each vertex and edge._\n","user":"anonymous","dateUpdated":"2018-12-31T16:10:11+0200","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Introduction</h2>\n<p>GraphX is the Spark API for graph processing. </p>\n<p>It provides a wrapper around an RDD called <strong>resilient distributed property graph</strong>. </p>\n<p><em>The property graph is a directed multigraph with properties attached to each vertex and edge.</em></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1546264844765_-1175940704","id":"20160907-140811_5272388","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2018-12-31T16:10:11+0200","dateFinished":"2018-12-31T16:10:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4753"},{"title":"Example Graph","text":"%spark\n\n\ncase class Person(name:String, age:Int)\n\nval vertices = sc.parallelize(Array(\n\t(1L, Person(\"John\", 39)), \n\t(2L, Person(\"Alice\", 39)), \n\t(3L, Person(\"Peter\", 12)), \n\t(4L, Person(\"Susan\", 12))\n))\n\nval edges = sc.parallelize(Array(\n\tEdge(4L, 3L, \"friend\"),\n\tEdge(3L, 1L, \"father\"), \n\tEdge(3L, 2L, \"mother\"),\n\tEdge(1L, 2L, \"marriedTo\")\n))\n\nval graph = Graph(vertices, edges)\n\ngraph.vertices.count()\n\ngraph.vertices.collect().foreach(println(_))\n\ngraph.edges.count()\n\ngraph.edges.collect().foreach(println(_))\n","user":"anonymous","dateUpdated":"2019-01-02T11:56:33+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Person\nvertices: org.apache.spark.rdd.RDD[(Long, Person)] = ParallelCollectionRDD[363] at parallelize at <console>:64\nedges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[String]] = ParallelCollectionRDD[364] at parallelize at <console>:62\ngraph: org.apache.spark.graphx.Graph[Person,String] = org.apache.spark.graphx.impl.GraphImpl@72f5aa9b\nres97: Long = 4\n(4,Person(Susan,12))\n(1,Person(John,39))\n(2,Person(Alice,39))\n(3,Person(Peter,12))\nres99: Long = 4\nEdge(4,3,friend)\nEdge(3,1,father)\nEdge(3,2,mother)\nEdge(1,2,marriedTo)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=65","http://192.168.9.185:4040/jobs/job?id=66","http://192.168.9.185:4040/jobs/job?id=67","http://192.168.9.185:4040/jobs/job?id=68"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844783_-977616266","id":"20180415-211354_1326985759","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T11:56:33+0200","dateFinished":"2019-01-02T11:56:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4754"},{"title":"Graph Reversal example","text":"%spark\n\nval reversedGraph = graph.reverse\n\nreversedGraph.vertices.collect().foreach(println(_))\nreversedGraph.edges.collect().foreach(println(_))\n","user":"anonymous","dateUpdated":"2019-01-02T12:12:09+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reversedGraph: org.apache.spark.graphx.Graph[Person,String] = org.apache.spark.graphx.impl.GraphImpl@7ad7aecc\n(4,Person(Susan,12))\n(1,Person(John,39))\n(2,Person(Alice,39))\n(3,Person(Peter,12))\nEdge(3,4,friend)\nEdge(1,3,father)\nEdge(2,3,mother)\nEdge(2,1,marriedTo)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=69","http://192.168.9.185:4040/jobs/job?id=70"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844784_535717975","id":"20180416-135844_127754365","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T11:56:48+0200","dateFinished":"2019-01-02T11:56:50+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4755"},{"title":"Mapping Edges and Vertices","text":"%spark\n\nval newgraph1 = graph.mapVertices(\n    (vId, vData) => {\n        vData match {\n            case Person(name, age) => Person(name.toUpperCase(), age)\n        }\n    }\n)\n\nnewgraph1.vertices.collect().foreach(println(_))\n\ncase class Relationship(relation:String)\n\nval newgraph2 = graph.mapEdges(\n    (partId, iter) => iter.map(edge => Relationship(edge.attr))\n)\n\nnewgraph2.edges.collect().foreach(println(_))\n\ncase class PersonExt(name:String, age:Int, children:Int=0, friends:Int=0, married:Boolean=false)\n\n","user":"anonymous","dateUpdated":"2019-01-02T11:56:53+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"newgraph1: org.apache.spark.graphx.Graph[Person,String] = org.apache.spark.graphx.impl.GraphImpl@6a5b33ff\n(4,Person(SUSAN,12))\n(1,Person(JOHN,39))\n(2,Person(ALICE,39))\n(3,Person(PETER,12))\ndefined class Relationship\nnewgraph2: org.apache.spark.graphx.Graph[Person,Relationship] = org.apache.spark.graphx.impl.GraphImpl@6552894a\nEdge(4,3,Relationship(friend))\nEdge(3,1,Relationship(father))\nEdge(3,2,Relationship(mother))\nEdge(1,2,Relationship(marriedTo))\ndefined class PersonExt\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=71","http://192.168.9.185:4040/jobs/job?id=72"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844784_1081800819","id":"20180416-130727_2002371610","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T11:56:53+0200","dateFinished":"2019-01-02T11:56:56+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4756"},{"title":"Describing the relationships in more verbose manner","text":"%spark\n\ngraph.triplets.map(\n  triplet => triplet.srcAttr + \" is the \" + triplet.attr + \" of \" + triplet.dstAttr\n).collect.foreach(println(_))\n","user":"anonymous","dateUpdated":"2019-01-02T11:57:01+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Person(Susan,12) is the friend of Person(Peter,12)\nPerson(Peter,12) is the father of Person(John,39)\nPerson(Peter,12) is the mother of Person(Alice,39)\nPerson(John,39) is the marriedTo of Person(Alice,39)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=73"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844784_757986369","id":"20180416-133645_1367509927","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T11:57:01+0200","dateFinished":"2019-01-02T11:57:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4757"},{"title":"InDegrees, Outdegress and Degrees","text":"%spark\n\nprintln(\"In Degrees of Vertices\")\ngraph.inDegrees.collect().foreach(println(_))\n\nprintln(\"Out Degrees of Vertices\")\ngraph.outDegrees.collect().foreach(println(_))\n\nprintln(\"Degrees of Vertices\")\ngraph.degrees.collect().foreach(println(_))\n\nprintln(\"Vertices with a fan-in more than 1\")\nval x = graph.inDegrees.filter( vertex =>\n    vertex match { \n        case(vId, inDegree) => inDegree > 1\n    }\n)\nx.collect().foreach(println(_))\n\nprintln(\"Vertices with a fan-out more than 1\")\nval x = graph.outDegrees.filter( vertex =>\n    vertex match { \n        case(vId, outDegree) => outDegree > 1\n    }\n)\nx.collect().foreach(println(_))\n\n","user":"anonymous","dateUpdated":"2019-01-02T11:57:07+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"In Degrees of Vertices\n(1,1)\n(2,2)\n(3,1)\nOut Degrees of Vertices\n(4,1)\n(1,1)\n(3,2)\nDegrees of Vertices\n(4,1)\n(1,2)\n(2,2)\n(3,3)\nVertices with a fan-in more than 1\nx: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[415] at RDD at VertexRDD.scala:57\n(2,2)\nVertices with a fan-out more than 1\nx: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[417] at RDD at VertexRDD.scala:57\n(3,2)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=74","http://192.168.9.185:4040/jobs/job?id=75","http://192.168.9.185:4040/jobs/job?id=76","http://192.168.9.185:4040/jobs/job?id=77","http://192.168.9.185:4040/jobs/job?id=78"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844785_-1790712731","id":"20180416-133904_614567139","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T11:57:07+0200","dateFinished":"2019-01-02T11:57:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4758"},{"title":"Aggregating Messages","text":"%spark\n\nval newGraphExt = newgraph2.mapVertices((vid, person) => PersonExt(person.name, person.age))\n\nnewGraphExt.vertices.collect().foreach(println(_))\n\nval aggVertices = newGraphExt.aggregateMessages((ctx:EdgeContext[PersonExt, Relationship, Tuple3[Int, Int, Boolean]]) => {\n        if(ctx.attr.relation == \"marriedTo\")\n        { ctx.sendToSrc((0, 0, true)); ctx.sendToDst((0, 0, true)); }\n        else if(ctx.attr.relation == \"mother\" || ctx.attr.relation == \"father\")\n        { ctx.sendToDst((1, 0, false)); }\n        else if(ctx.attr.relation.contains(\"friend\"))\n        { ctx.sendToDst((0, 1, false)); ctx.sendToSrc((0, 1, false));}\n    },\n    (msg1:Tuple3[Int, Int, Boolean], msg2:Tuple3[Int, Int, Boolean]) =>\n        (msg1._1+msg2._1, msg1._2+msg2._2, msg1._3 || msg2._3)\n)\n\naggVertices.collect.foreach(println(_))\n","user":"anonymous","dateUpdated":"2019-01-02T12:09:47+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"newGraphExt: org.apache.spark.graphx.Graph[PersonExt,Relationship] = org.apache.spark.graphx.impl.GraphImpl@c2176e0\n(4,PersonExt(Susan,12,0,0,false))\n(1,PersonExt(John,39,0,0,false))\n(2,PersonExt(Alice,39,0,0,false))\n(3,PersonExt(Peter,12,0,0,false))\naggVertices: org.apache.spark.graphx.VertexRDD[(Int, Int, Boolean)] = VertexRDDImpl[461] at RDD at VertexRDD.scala:57\n(4,(0,1,false))\n(1,(1,0,true))\n(2,(1,0,true))\n(3,(0,1,false))\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.9.185:4040/jobs/job?id=87","http://192.168.9.185:4040/jobs/job?id=88"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1546264844786_-458230993","id":"20180416-143522_1109948344","dateCreated":"2018-12-31T16:00:44+0200","dateStarted":"2019-01-02T12:09:47+0200","dateFinished":"2019-01-02T12:09:49+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4759"}],"name":"Lab 15.1 Example - GraphX Creation Structural Operators","id":"2DZWHPGQF","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}