# Lab: Tiered Storage

### Aim: see various cache criteria, what happens in case space has/doesn't have a mirror,deleting/not deleting pu metadata before new deployment, ZooKeeper storage.
  

# Instructions

1. Start the app:

    go to gs-home/bin

    run ./gs.sh host run-agent --auto --gsc=3

2. Go to space module -> CustomSpaceConfig remark mirror and data source configuration
3. Build space module
4. Go to ops-ui localhost:8090
5. Deploy space service 1,1 context property:pu.autogenerated-instance-sla true.
6. Run feeder from dev environment
7. See the objects and query them using ops-ui (see memory only checkbox)
8. Undeploy the space service (drain attempt 10 sec timeout )
9. Go to Rest api page localhost:8090/v2
10. Get Undeployed list
11. Run ZooKeeperAttributeStoreReader to see what kept in ZK storage.
12. Redploy the space service. Examine primary log, See objects inside the space (see what is missing)
13. Undeploy the space service
14. Connect locally to sqlite instance run queries directly on that database
15. Go to Rest api page localhost:8090/v2, Delete pu metadata
16. Run ZooKeeperAttributeStoreReader to see that data was cleared
17. Start a database create tables for Data1 till Data4
18. Go to space module and mirror module -> CustomSpaceConfig activate/change mirror and data source configuration
19. Go to ops-ui Deploy space service as in step 5, then deploy the mirror service
20. Repeat steps 6-15.

